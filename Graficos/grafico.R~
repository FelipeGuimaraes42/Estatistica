#Carregando os dados da pesquisa
dados <- read.csv("code.csv", sep = ";", dec = ",", header = T)

attach(dados)

#Relacionando o numero de estudantes com a expectativa do mercado
curso_labels <- c("Eng.Aeroespacial", "Eng.Ambiental" , "Eg.Controle" , "Eng.Minas",
                  "Eng.Produção"    , "Eng.Sistemas"  , "Eng.Mecanica", "Eng.Metalurgica",
                  "Geologia"        , "Lic.Matematica", "Matematica"  , "Quimica",
                  "SI")

contribui_labels <- c("Salário", "Mercado de trabalho" , "Vocação", "Estabilidade",
                      "Interesse pela área de pesquisa", "Sal/Mer",
                      "Sal/Voc", "Mer/Voc", "Voc/Int",
                      "Sala/Mer/Voc", "Sal/Voc/Est")

#Frequencia absoluta e relativa
cur_con_freq_a <- table(contribui, curso)
cur_con_freq_r <- round(prop.table(cur_con_freq_a, margin = 2) * 100, 2)

#Criando o grafico de barras
png(file = "barplot_contribui_curso.png")

barplot (
    cur_con_freq_r,
    ylab      = "Frequencia relativa de contribuição (%)", 
    main      = "Grafico de barras - contribui por curso",
    names.arg = curso_labels,
    col       = rainbow(length(contribui_labels)),
    las       = 2,
    ylim      = c(0,150),
    cex.names = 0.6
)

#Legenda
legend("topright", contribui_labels, fill = rainbow(length(contribui_labels)), cex = 0.6)
